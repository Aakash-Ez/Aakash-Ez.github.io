<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Getting Started with RNNs</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <!-- Slick Carousel -->
  <link rel="stylesheet" href="https://aakash-ez.github.io/plugins/slick/slick.css" />
  <link rel="stylesheet" href="https://aakash-ez.github.io/plugins/slick/slick-theme.css" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://aakash-ez.github.io/plugins/font-awesome/css/font-awesome.min.css" />

  <!-- Magnific Popup -->
  <link rel="stylesheet" href="https://aakash-ez.github.io/plugins/magnafic-popup/magnific-popup.css" />

  <!-- Stylesheets -->
  
  <link href="https://aakash-ez.github.io/scss/style.min.css" rel="stylesheet" />

  <!--Favicon-->
  <link rel="shortcut icon" href="https://aakash-ez.github.io/images/favicon.ico" type="image/x-icon" />
  <link rel="icon" href="https://aakash-ez.github.io/images/favicon.png" type="image/x-icon" />
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HRRGJWNWEC"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-HRRGJWNWEC');
  </script>
  
</head>

<body>
  <nav class="navbar navbar-expand-lg fixed-top">
  <div class="container">
    <a href="https://aakash-ez.github.io/" class="navbar-brand">
      <img src="https://aakash-ez.github.io/images/site-navigation/logo.png" alt="site-logo">
    </a>
    <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#navbarCollapse">
      <span class="navbar-toggler-icon"></span>
      <span class="navbar-toggler-icon"></span>
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
      <ul class="nav navbar-nav main-navigation my-0 mx-auto">
        
        
        <li class="nav-item">
          <a href="https://aakash-ez.github.io/#home"
            class="nav-link text-dark text-sm-center p-2 ">Home</a>
        </li>
        
        <li class="nav-item">
          <a href="https://aakash-ez.github.io//off-topic"
            class="nav-link text-dark text-sm-center p-2 ">Off Topic</a>
        </li>
        
        <li class="nav-item">
          <a href="https://aakash-ez.github.io//blog"
            class="nav-link text-dark text-sm-center p-2 ">Blog</a>
        </li>
        
        <li class="nav-item">
          <a href="https://aakash-ez.github.io//contact"
            class="nav-link text-dark text-sm-center p-2 ">Contact</a>
        </li>
        
      </ul>
    </div>
  </div>
</nav>
  <div id="content">
    

<header class="breadCrumb">
  <div class="container">
    <div class="row">
      <div class="col-lg-10 col-md-12 offset-lg-1 offset-md-0 text-center">
        <h3 class="breadCrumb__title">Getting Started with RNNs</h3>
        <nav aria-label="breadcrumb" class="d-flex justify-content-center">
          <ol class="breadcrumb align-items-center">
            <li class="breadcrumb-item"><a href=https://aakash-ez.github.io/>Home</a></li>
            <li class="breadcrumb-item"><a href=https://aakash-ez.github.io/blog>All Post</a></li>
            <li class="breadcrumb-item active">Aakash Ezhilan</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
</header>

<section class="section singleBlog">
  <div class="svg-img">
      <img src=https://aakash-ez.github.io/images/hero/figure-svg.svg alt="">
  </div>
  <div class="animate-shape">
      
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 600 600">
          <defs>
              <linearGradient id="d" x1="0.929" y1="0.111" x2="0.263" y2="0.935" gradientUnits="objectBoundingBox">
                  <stop offset="0" stop-color="#f1f6f9" />
                  <stop offset="1" stop-color="#f1f6f9" stop-opacity="0" />
              </linearGradient>
          </defs>
          <g data-name="blob-shape (3)">
              <path class="blob" fill="url(#d)"
                  d="M455.4 151.1c43.1 36.7 73.4 92.8 60.8 136.3-12.7 43.5-68.1 74.4-111.3 119.4-43.1 45-74 104.1-109.8 109-35.9 5-76.7-44.2-111.8-89.2-35.2-45-64.7-85.8-70.8-132.6-6-46.8 11.6-99.6 46.7-136.3 35.2-36.6 88-57.2 142.4-58.8 54.5-1.7 110.6 15.6 153.8 52.2z" />
          </g>
      </svg>
  </div>
  <div class="animate-pattern">
      <img src=https://aakash-ez.github.io/images/service/background-pattern.svg alt="background-shape">
  </div>
  <div class="container">
      <div class="row">
          <div class="col-lg-12">
              <div class="singleBlog__feature">
                  <img src=https://aakash-ez.github.io/images/blog/getting-started-with-rnn/featured.png alt="feature-image">
              </div>
          </div>
      </div>
      <div class="row mt-5">
          <div class="col-lg-12">
              <div class="singleBlog__content">
                  <p>Many real life scenarios generate sequential data, where the details of the preceding states play an important role in determining the outcome of the current state. Examples of sequential data are DNA Sequence, Text Documents, Stock prices etc. In such cases, the output of a particular state, will not only depend on the input provided but also the previous states encountered by our model.</p>
<p>Let us consider the example of Natural Language Translation. While we could have a lookup table that translates the sentence provided word-by-word into another language, this will lose the grammatical structure and in many cases the meaning the original sentence was trying to convey. This is because in a word by word model, rather than understanding the meaning of the words with respect to the context they appear in, we are just translating it to an equivalent word from our desired output language.</p>
<p>On the other hand, literal translation understands the meaning of the word or phrase with respect to the context they appear in and then translates it to our desired output language. This plays an important role when dealing with idioms, ambiguous words etc. which cannot be directly mapped to a word or phrase in another language. This is where RNN-like architecture comes into picture, where we process the sequence as a whole.</p>
<div align="center">
    <img src="https://aakash-ez.github.io/images/blog/getting-started-with-rnn/image-1.png" style="max-width: 100%;"/>
    <i><div style="text-align: center">Figure 1. Diagram of different RNN sequence types. Credit: Andrej Karpathy</div></i><br>
</div>
<h3 id="introduction-to-rnn">Introduction to RNN</h3>
<p>RNN stands for Recurrent Neural Networks, which is a class of artificial neural networks where there exists a connection between nodes, forming a directed graph along the temporal sequence. This means the network, while might take input in a particular state, will also use the state in the node/neuron was in the previous iterations. This way, we are able to analyze sequence of data which are related to each other.</p>
<p>One of the common and most successful RNN architecture is called LSTM (Long Short Term Memory) whose architecture has been depicted in Figure 2. The various gates that are present in a common LSTM architecture has been explained in detail in this particular <a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">blogpost</a>.</p>
<div align="center">
    <img src="https://aakash-ez.github.io/images/blog/getting-started-with-rnn/image-2.png" style="max-width: 100%;"/>
    <i><div style="text-align: center">Figure 2. LSTM Architecture Credits Analytics Vidhya</div></i><br>
</div>
<h3 id="sentiment-analysis-using-rnn">Sentiment Analysis Using RNN</h3>
<p>Let us now try developing a model for sentiment analysis on twitter samples dataset, we considered in the <a href="http://localhost:1313/blog/nb-nltk-sentiment-analysis/">previous blogpost</a>. We are doing so that we can make a comparison between both the methodologies and see which works better for this particular use case. After importing and preprocessing the twitter samples corpus, we are going to identify how often does a word occur in positive tweets and negative tweets. The positive and negative frequency thus found will act as the features for our RNN Model.</p>
<p>Using the positive and negative counts of words, we are going to present the tweets as a Nx2 matrix, with the first column containing the positive frequency of the word and second column representing the negative frequency. The below figure, depicts the way tweets are represented in different stages.</p>
<div align="center">
    <img src="https://aakash-ez.github.io/images/blog/getting-started-with-rnn/image-3.png" style="border: 1px solid #555; max-width: 100%;"/>
    <i><div style="text-align: center"></div></i><br>
</div>
<p>Let us now implement an RNN using Keras, to perform sentiment analysis on the given dataset. The first step is to import the necessary function from Keras.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">from</span> keras.models <span style="color:#f92672">import</span> Sequential
<span style="color:#f92672">from</span> keras.layers <span style="color:#f92672">import</span> Dense, Dropout, LSTM, Reshape
<span style="color:#f92672">from</span> keras.optimizers <span style="color:#f92672">import</span> Adam
</code></pre></div><p>Next, we will be writing a function which will make us our RNN model using LSTM Architecture.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_model</span>(inp_shape,batch_size):
    model <span style="color:#f92672">=</span> Sequential()
    model<span style="color:#f92672">.</span>add(LSTM(<span style="color:#ae81ff">512</span>, input_shape <span style="color:#f92672">=</span> inp_shape, activation <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;relu&#39;</span>))
    model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">1024</span>,activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>))
    model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.1</span>))
    model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">2048</span>,activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>))
    model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.1</span>))
    model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">2048</span>,activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>))
    model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.1</span>))
    model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">1</span>,activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sigmoid&#39;</span>))
    <span style="color:#66d9ef">return</span> model
BATCH_SIZE <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>
model <span style="color:#f92672">=</span> create_model(X_array[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>shape,BATCH_SIZE)
model<span style="color:#f92672">.</span>summary()
</code></pre></div><p>The above code generates our model which has been summarized below.</p>
<div align="center">
    <img src="https://aakash-ez.github.io/images/blog/getting-started-with-rnn/image-4.png" style="max-width: 100%;"/>
    <i><div style="text-align: center"></div></i><br>
</div>
<p>Let us now train our model, using Adam’s optimizer. We are going to use Binary Cross Entropy loss function as the output generated by our model belongs to two classes, positive or negative. Once trained, you will see that model has an accuracy of around 86% on test dataset, which is significantly better than Naive Bayes Approach.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">opt <span style="color:#f92672">=</span> Adam(learning_rate<span style="color:#f92672">=</span><span style="color:#ae81ff">0.00005</span>)
model<span style="color:#f92672">.</span>compile(optimizer<span style="color:#f92672">=</span>opt, loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;binary_crossentropy&#39;</span>, metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;accuracy&#39;</span>])
history <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(x<span style="color:#f92672">=</span>x_train,y<span style="color:#f92672">=</span>y_train,epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">35</span>,validation_split<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>,batch_size<span style="color:#f92672">=</span>BATCH_SIZE,validation_steps<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>,shuffle<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</code></pre></div><p>While accuracy of 86% is good, it can be further improved by processing the tweets better and also using concepts such as word embedding to make sure that meaning of the words is better understood. Furthermore the model implemented is simplistic and a more sophisticated model can do a better approach with the given data.</p>
<div align="center">
    <img src="https://aakash-ez.github.io/images/blog/getting-started-with-rnn/image-5.png" style="max-width: 100%;"/>
    <i><div style="text-align: center">Figure 3. Accuracy and Loss of Train and Validation Data</div></i><br>
</div>
<p>You can find the code for this blogpost in <a href="https://github.com/Aakash-Ez/Blog_Programs/tree/main/Getting%20Started%20with%20RNN">this github repo</a>.</p>

              </div>
          </div>
      </div>
  </div>
</section>


  </div>
  <section class="footer" id="contact">
	<div class="footer__background_shape">
		<svg viewBox="0 0 1920 79">
			<path d="M0 0h1920v79L0 0z" data-name="Path 1450" />
		</svg>
	</div>
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div class="footer__cta">
					<div class="shape-1">
						<svg xmlns="http://www.w3.org/2000/svg" width="357" height="315.029" viewBox="0 0 357 315.029">
							<path data-name="Path 1449"
								d="M76.1-157.222C91.746-135.8 87.2-94.273 99.993-61.945c12.7 32.328 42.661 55.459 39.248 73.282-3.318 17.823-40.007 30.337-65.6 43.325-25.5 12.988-39.912 26.545-60.01 42.566-20.1 16.116-46.074 34.6-63.328 27.682-17.349-6.921-25.976-39.153-59.915-59.82s-93.1-29.768-105.325-51.478 22.373-56.028 43.609-93.949c21.331-37.921 29.2-79.35 53.563-96.793 24.459-17.444 65.414-10.9 103.9-6.921 38.396 3.982 74.326 5.404 89.965 26.829z"
								transform="translate(217.489 188.626)" />
						</svg>
					</div>
					<div class="shape-2">
						<svg xmlns="http://www.w3.org/2000/svg" width="357" height="315.029" viewBox="0 0 357 315.029">
							<path data-name="Path 1449"
								d="M76.1-157.222C91.746-135.8 87.2-94.273 99.993-61.945c12.7 32.328 42.661 55.459 39.248 73.282-3.318 17.823-40.007 30.337-65.6 43.325-25.5 12.988-39.912 26.545-60.01 42.566-20.1 16.116-46.074 34.6-63.328 27.682-17.349-6.921-25.976-39.153-59.915-59.82s-93.1-29.768-105.325-51.478 22.373-56.028 43.609-93.949c21.331-37.921 29.2-79.35 53.563-96.793 24.459-17.444 65.414-10.9 103.9-6.921 38.396 3.982 74.326 5.404 89.965 26.829z"
								transform="translate(217.489 188.626)" />
						</svg>
					</div>
					<div class="text-light footer__cta_content">
						<span>Contact me</span>
						<h2 class="mb-0">Let’s Start a Project</h2>
					</div>
					<div class="footer__cta_action">
						<a class="btn btn-light btn-zoom" href="https://aakash-ez.github.io/contact">Get in
							touch</a>
					</div>
				</div>
			</div>
		</div>
		<div class="row footer__widget">
			<div class="col-lg-4">
				<div class="footer__widget_logo mb-5">
					<img src="https://aakash-ez.github.io/images/contact/widget-logo.png" alt="widget-logo">
				</div>
			</div>
			
			<div class="col-lg-4">
				<div class="text-light footer__widget_address mb-5">
					<h4 class="base-font">Address</h4>
					
					<ul class="fa-ul small">
						<li class="mb-2"><a class="text-light" href="tel:&#43;%2891%29%20962%20936%205421"><span class="fa-li"><i
										class="fa fa-phone"></i></span>&#43;(91) 962 936 5421</a></li>
						<li class="mb-2"><a class="text-light" href="mailto:aakash.ezhilan@gmail.com"><span class="fa-li"><i
										class="fa fa-envelope"></i></span>aakash.ezhilan@gmail.com</a></li>
						<li class="mb-2">
							<span class="fa-li"><i class="fa fa-map-marker"></i></span>Chennai, Tamil Nadu, India. Pincode: 603103</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<div class="row footer__footer">
			<div class="col-lg-6">
				<div class="footer__footer_copy text-light">
					<p>Made on top of Portio Template</p>
				</div>
			</div>
			<div class="col-lg-6">
				<div class="footer__footer_social">
					<ul class="unstyle-list">
						
						
						<li class="d-inline-block mx-2"><a class="text-light" target="_blank" href="https://www.facebook.com/aakash.ezhilan"><i
									class="fa fa-facebook-official"></i></a>
						</li>
						
						<li class="d-inline-block mx-2"><a class="text-light" target="_blank" href="https://www.linkedin.com/in/aakash-ez"><i
									class="fa fa-linkedin-square"></i></a>
						</li>
						
						<li class="d-inline-block mx-2"><a class="text-light" target="_blank" href="https://github.com/Aakash-Ez/"><i
									class="fa fa-github-square"></i></a>
						</li>
						
						<li class="d-inline-block mx-2"><a class="text-light" target="_blank" href="https://twitter.com/aakash_ezhilan"><i
									class="fa fa-twitter-square"></i></a>
						</li>
						
					</ul>
				</div>
			</div>
		</div>
	</div>
</section>
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR%20GOOGLE%20MAP%20API&libraries=geometry"></script>
<script src="https://aakash-ez.github.io/plugins/jQuery/jquery.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/bootstrap/bootstrap.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/slick/slick.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/waypoint/jquery.waypoints.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/magnafic-popup/jquery.magnific-popup.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/tweenmax/TweenMax.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/imagesloaded/imagesloaded.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/masonry/masonry.min.js"></script>

<script src="https://aakash-ez.github.io/js/form-handler.min.js"></script>

<script src="https://aakash-ez.github.io/js/script.min.js"></script>

</body>

</html>