<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Part I: Image Classification Using CNNs</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <!-- Slick Carousel -->
  <link rel="stylesheet" href="https://aakash-ez.github.io/plugins/slick/slick.css" />
  <link rel="stylesheet" href="https://aakash-ez.github.io/plugins/slick/slick-theme.css" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://aakash-ez.github.io/plugins/font-awesome/css/font-awesome.min.css" />

  <!-- Magnific Popup -->
  <link rel="stylesheet" href="https://aakash-ez.github.io/plugins/magnafic-popup/magnific-popup.css" />

  <!-- Stylesheets -->
  
  <link href="https://aakash-ez.github.io/scss/style.min.css" rel="stylesheet" />

  <!--Favicon-->
  <link rel="shortcut icon" href="https://aakash-ez.github.io/images/favicon.ico" type="image/x-icon" />
  <link rel="icon" href="https://aakash-ez.github.io/images/favicon.png" type="image/x-icon" />
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HRRGJWNWEC"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-HRRGJWNWEC');
  </script>
  
</head>

<body>
  <nav class="navbar navbar-expand-lg fixed-top">
  <div class="container">
    <a href="https://aakash-ez.github.io/" class="navbar-brand">
      <img src="https://aakash-ez.github.io/images/site-navigation/logo.png" alt="site-logo">
    </a>
    <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#navbarCollapse">
      <span class="navbar-toggler-icon"></span>
      <span class="navbar-toggler-icon"></span>
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
      <ul class="nav navbar-nav main-navigation my-0 mx-auto">
        
        
        <li class="nav-item">
          <a href="https://aakash-ez.github.io/#home"
            class="nav-link text-dark text-sm-center p-2 ">Home</a>
        </li>
        
        <li class="nav-item">
          <a href="https://aakash-ez.github.io//off-topic"
            class="nav-link text-dark text-sm-center p-2 ">Off Topic</a>
        </li>
        
        <li class="nav-item">
          <a href="https://aakash-ez.github.io//blog"
            class="nav-link text-dark text-sm-center p-2 ">Blog</a>
        </li>
        
        <li class="nav-item">
          <a href="https://aakash-ez.github.io//contact"
            class="nav-link text-dark text-sm-center p-2 ">Contact</a>
        </li>
        
      </ul>
    </div>
  </div>
</nav>
  <div id="content">
    

<header class="breadCrumb">
  <div class="container">
    <div class="row">
      <div class="col-lg-10 col-md-12 offset-lg-1 offset-md-0 text-center">
        <h3 class="breadCrumb__title">Part I: Image Classification Using CNNs</h3>
        <nav aria-label="breadcrumb" class="d-flex justify-content-center">
          <ol class="breadcrumb align-items-center">
            <li class="breadcrumb-item"><a href=https://aakash-ez.github.io/>Home</a></li>
            <li class="breadcrumb-item"><a href=https://aakash-ez.github.io/blog>All Post</a></li>
            <li class="breadcrumb-item active">Aakash Ezhilan</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
</header>

<section class="section singleBlog">
  <div class="svg-img">
      <img src=https://aakash-ez.github.io/images/hero/figure-svg.svg alt="">
  </div>
  <div class="animate-shape">
      
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 600 600">
          <defs>
              <linearGradient id="d" x1="0.929" y1="0.111" x2="0.263" y2="0.935" gradientUnits="objectBoundingBox">
                  <stop offset="0" stop-color="#f1f6f9" />
                  <stop offset="1" stop-color="#f1f6f9" stop-opacity="0" />
              </linearGradient>
          </defs>
          <g data-name="blob-shape (3)">
              <path class="blob" fill="url(#d)"
                  d="M455.4 151.1c43.1 36.7 73.4 92.8 60.8 136.3-12.7 43.5-68.1 74.4-111.3 119.4-43.1 45-74 104.1-109.8 109-35.9 5-76.7-44.2-111.8-89.2-35.2-45-64.7-85.8-70.8-132.6-6-46.8 11.6-99.6 46.7-136.3 35.2-36.6 88-57.2 142.4-58.8 54.5-1.7 110.6 15.6 153.8 52.2z" />
          </g>
      </svg>
  </div>
  <div class="animate-pattern">
      <img src=https://aakash-ez.github.io/images/service/background-pattern.svg alt="background-shape">
  </div>
  <div class="container">
      <div class="row">
          <div class="col-lg-12">
              <div class="singleBlog__feature">
                  <img src=https://aakash-ez.github.io/images/blog/cnn-part-1/featured.png alt="feature-image">
              </div>
          </div>
      </div>
      <div class="row mt-5">
          <div class="col-lg-12">
              <div class="singleBlog__content">
                  <p>Images and other media content are becoming a predominant part of data in 21st century due to the rise of smartphones and the ease at which pictures can be taken nowadays. Images are also becoming common in other domains such as medical, engineering etc. Therefore it becomes important for us to understand the nature of these digital images and how to address them in a deep learning domain.</p>
<h3 id="nature-of-digital-images">Nature of Digital Images</h3>
<p>Digital Images can often be described as mere rectangular collection of pixels. Each of these pixels store a color represented using the RGB Model. Each pixel in an image has a color code similar to those in Table 1 with each of RGB taking a value between 0 and 255. An accumulation of 1000×1000 such pixels make up a image of size 1 megapixel.</p>





<table class="table table-striped table-bordered">
<thead>
<tr>
<th style="text-align:center">Color Name</th>
<th style="text-align:center">Hex Code</th>
<th style="text-align:center">RGB Values</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">White</td>
<td style="text-align:center">FFFFFF</td>
<td style="text-align:center">(255,255,255)</td>
</tr>
<tr>
<td style="text-align:center">Black</td>
<td style="text-align:center">000000</td>
<td style="text-align:center">(0,0,0)</td>
</tr>
<tr>
<td style="text-align:center">Red</td>
<td style="text-align:center">FF0000</td>
<td style="text-align:center">(255,0,0)</td>
</tr>
<tr>
<td style="text-align:center">Green</td>
<td style="text-align:center">00FF00</td>
<td style="text-align:center">(0,255,0)</td>
</tr>
<tr>
<td style="text-align:center">Blue</td>
<td style="text-align:center">0000FF</td>
<td style="text-align:center">(0,0,255)</td>
</tr>
</tbody>
</table>

<p>Now we separate this into three different channel for each color (RGB). This means for representing a 1000×1000 pixel image we need three 1000×1000 matrices with each element containing a value between 0 and 255. By convention we take first 1000×1000 matrix as the values of red, second as green and third as blue. We can see that the matrix can be represented as 1000x1000x3 where three denotes the number of channels.</p>
<div align="center">
    <img src="https://aakash-ez.github.io/images/blog/cnn-part-1/image-1.png" style="max-width: 100%;"/>
    <i><div style="text-align: center">Figure 1. Image as a 3D matrix with RGB channel.</div></i><br>
</div>
<h3 id="convolution-operation">Convolution Operation</h3>
<p>Convolution Operation in mathematics is an operation between two functions which produces a third function, which depicts the affect of one function on the shape of the other. The same logic is going to be used in convolutional neural networks where we have a filter of size fxf (referred to as kernel) which is convoluted on the image matrix of size NxN.</p>
<p><em><strong>Note:</strong> In mathematics while performing convolution operation, we transpose and shift the second function, however this is not done in deep learning. The convolution operation in deep learning is equivalent to cross-correlation in mathematics.</em></p>
<div align="center">
    <img src="https://aakash-ez.github.io/images/blog/cnn-part-1/image-2.png" style="max-width: 100%;"/>
    <i><div style="text-align: center">Figure 2. Image 5×5 and filter 3×3 matrices.</div></i><br>
</div>
<p>Let us consider the matrices in Figure 2. Using the 3×3 filter we can perform convolution over our image. Let us consider the first 3×3 sub-matrix present in our image [[1,2,3],[4,5,6],[7,8,9]]. Performing convolution using our filter we will get output as 15. Similarly when we do convolution over the rest of the image we will get the following matrix as output.</p>
<div align="center">
    <img src="https://aakash-ez.github.io/images/blog/cnn-part-1/image-3.png" style="max-width: 100%;"/>
    <i><div style="text-align: center">Figure 3. Output matrix of the convolution operation.</div></i><br>
</div>
<p>In a convolutional neural network, we have many such filters which learn to identify features from the images. If we have n filters in a layer then the output will have n convolved matrices stacked together. The size of convolved image for a filter of size fxf and image of size NxN can be found using the following equation</p>
<div align="center">
    <div style="text-align: center"><b><i>
image(N,N) ∗ filter(f,f) = OutputMatix(N−f+ 1,N−f+ 1)
</i></b></div><br>
</div>
<h3 id="padding">Padding</h3>
<p>Padding refers to process of adding a border to the image matrix (generally filled with 0’s) so that the Output Matrix of convolution operation does not shrink and the corner elements are given equal importance. The number of borders to be added to the image is determined by its hyper parameter. Figure 4 shows a simple 3×3 image matrix that is padded symmetrically with padding = 1.</p>
<div align="center">
    <img src="https://aakash-ez.github.io/images/blog/cnn-part-1/image-4.png" style="max-width: 100%;"/>
    <i><div style="text-align: center">Figure 4. Single layer of padding with zero.</div></i><br>
</div>
<p>From the Figure 4 we can see that on padding symmetrically, the dimensions of padded matrix increases by 2 * pad in height and width. Therefore in output matrix equation, image matrix NxN will now be (N+ 2 * pad) x (N + 2 * pad). Therefore we can rewrite the dimension of Output Matrix as as:</p>
<div align="center">
    <div style="text-align: center"><b><i>
[H,W] = [N+ 2∗pad−f+ 1,N+ 2∗pad−f+ 1]
</i></b></div><br>
</div>
<p>If we perform convolution operation on the padded matrix in Figure 4, with filter of size 3×3, we see that the resultant matrix will be of size 3×3 which is the same as dimension as the image matrix. Such padding value where the Output Matrix on convolution has the same size as the image matrix is called “same” padding. From a given filter size f we can find the padding required pad using above equation. The pad value for “same” padding for a given filter size f will be:</p>
<div align="center">
    <div style="text-align: center"><b><i>
pad = (f-1)/2
</i></b></div><br>
</div>
<h3 id="stride">Stride</h3>
<p>Stride is another common hyperparameter associated with convolution operation. It refers to the number of steps to be taken while performing convolution operation. In Figure 5 we can see that the first convolution is done at index (0,0) while the second convolution is done at (0,2). This is because the stride is 2 in this case and therefore it jumps by two while considering the next matrix for convolution. Similar pattern is followed while shifting rows therefore after (0,2) the next index will be (2,0).</p>
<p>Stride operation helps in reducing the computation time of convolution by reducing the number of submatrix considered from the image. This also will impact the size of Output Matrix as the dimensions of Output Matrix corresponds to the number of number of submatrix considered in Image. Therefore Output Matrix equation, along with strides can be rewritten as:</p>
<div align="center">
    <div style="text-align: center"><b><i>
H = (N+2*pad-f)//s + 1
</i></b></div><br>
</div>
<h3 id="convolution-layer">Convolution Layer</h3>
<p>Convolution Layer makes up the most important part of CNNs. Convolution Layer generally haven filters of size fxf which are used to perform convolution operation on the information in the preceding layer. Let us consider NxNxc be the dimension of the input layer. Then we need filters of dimension fxfxc to perform convolution operation. If we have n’ such filter present in the layer then the number weights to be computed will be fxfxcxn’. Apart from this we are need to compute bias for each filter, therefore we will be computing n’ biases.</p>
<p>It must be noted that the features detected by these filters are learnt while training the network and therefore the filter matrix are initially randomly assigned and over epochs these filter start learning a particular feature from the dataset provided to it. The filters in initial layers of a CNN tend to detect simple features such as edges. However as we go deeper into the network it can detect more complex features in the image. The total number of parameters in a convolution layer can be expressed as:</p>
<div align="center">
    <div style="text-align: center"><b><i>
parameters = f∗f∗c∗n′+n′
</i></b></div><br>
</div>
<p>In the next week’s post we will discuss the implementation of simple convolutional neural network to classify images present in Fashion MINST data, using Keras.</p>

              </div>
          </div>
      </div>
  </div>
</section>


  </div>
  <section class="footer" id="contact">
	<div class="footer__background_shape">
		<svg viewBox="0 0 1920 79">
			<path d="M0 0h1920v79L0 0z" data-name="Path 1450" />
		</svg>
	</div>
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div class="footer__cta">
					<div class="shape-1">
						<svg xmlns="http://www.w3.org/2000/svg" width="357" height="315.029" viewBox="0 0 357 315.029">
							<path data-name="Path 1449"
								d="M76.1-157.222C91.746-135.8 87.2-94.273 99.993-61.945c12.7 32.328 42.661 55.459 39.248 73.282-3.318 17.823-40.007 30.337-65.6 43.325-25.5 12.988-39.912 26.545-60.01 42.566-20.1 16.116-46.074 34.6-63.328 27.682-17.349-6.921-25.976-39.153-59.915-59.82s-93.1-29.768-105.325-51.478 22.373-56.028 43.609-93.949c21.331-37.921 29.2-79.35 53.563-96.793 24.459-17.444 65.414-10.9 103.9-6.921 38.396 3.982 74.326 5.404 89.965 26.829z"
								transform="translate(217.489 188.626)" />
						</svg>
					</div>
					<div class="shape-2">
						<svg xmlns="http://www.w3.org/2000/svg" width="357" height="315.029" viewBox="0 0 357 315.029">
							<path data-name="Path 1449"
								d="M76.1-157.222C91.746-135.8 87.2-94.273 99.993-61.945c12.7 32.328 42.661 55.459 39.248 73.282-3.318 17.823-40.007 30.337-65.6 43.325-25.5 12.988-39.912 26.545-60.01 42.566-20.1 16.116-46.074 34.6-63.328 27.682-17.349-6.921-25.976-39.153-59.915-59.82s-93.1-29.768-105.325-51.478 22.373-56.028 43.609-93.949c21.331-37.921 29.2-79.35 53.563-96.793 24.459-17.444 65.414-10.9 103.9-6.921 38.396 3.982 74.326 5.404 89.965 26.829z"
								transform="translate(217.489 188.626)" />
						</svg>
					</div>
					<div class="text-light footer__cta_content">
						<span>Contact me</span>
						<h2 class="mb-0">Let’s Start a Project</h2>
					</div>
					<div class="footer__cta_action">
						<a class="btn btn-light btn-zoom" href="https://aakash-ez.github.io/contact">Get in
							touch</a>
					</div>
				</div>
			</div>
		</div>
		<div class="row footer__widget">
			<div class="col-lg-4">
				<div class="footer__widget_logo mb-5">
					<img src="https://aakash-ez.github.io/images/contact/widget-logo.png" alt="widget-logo">
				</div>
			</div>
			
			<div class="col-lg-4">
				<div class="text-light footer__widget_address mb-5">
					<h4 class="base-font">Address</h4>
					
					<ul class="fa-ul small">
						<li class="mb-2"><a class="text-light" href="tel:&#43;%2891%29%20962%20936%205421"><span class="fa-li"><i
										class="fa fa-phone"></i></span>&#43;(91) 962 936 5421</a></li>
						<li class="mb-2"><a class="text-light" href="mailto:aakash.ezhilan@gmail.com"><span class="fa-li"><i
										class="fa fa-envelope"></i></span>aakash.ezhilan@gmail.com</a></li>
						<li class="mb-2">
							<span class="fa-li"><i class="fa fa-map-marker"></i></span>Chennai, Tamil Nadu, India. Pincode: 603103</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<div class="row footer__footer">
			<div class="col-lg-6">
				<div class="footer__footer_copy text-light">
					<p>Made on top of Portio Template</p>
				</div>
			</div>
			<div class="col-lg-6">
				<div class="footer__footer_social">
					<ul class="unstyle-list">
						
						
						<li class="d-inline-block mx-2"><a class="text-light" target="_blank" href="https://www.facebook.com/aakash.ezhilan"><i
									class="fa fa-facebook-official"></i></a>
						</li>
						
						<li class="d-inline-block mx-2"><a class="text-light" target="_blank" href="https://www.linkedin.com/in/aakash-ez"><i
									class="fa fa-linkedin-square"></i></a>
						</li>
						
						<li class="d-inline-block mx-2"><a class="text-light" target="_blank" href="https://github.com/Aakash-Ez/"><i
									class="fa fa-github-square"></i></a>
						</li>
						
						<li class="d-inline-block mx-2"><a class="text-light" target="_blank" href="https://twitter.com/aakash_ezhilan"><i
									class="fa fa-twitter-square"></i></a>
						</li>
						
					</ul>
				</div>
			</div>
		</div>
	</div>
</section>
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR%20GOOGLE%20MAP%20API&libraries=geometry"></script>
<script src="https://aakash-ez.github.io/plugins/jQuery/jquery.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/bootstrap/bootstrap.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/slick/slick.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/waypoint/jquery.waypoints.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/magnafic-popup/jquery.magnific-popup.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/tweenmax/TweenMax.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/imagesloaded/imagesloaded.min.js"></script>
<script src="https://aakash-ez.github.io/plugins/masonry/masonry.min.js"></script>

<script src="https://aakash-ez.github.io/js/form-handler.min.js"></script>

<script src="https://aakash-ez.github.io/js/script.min.js"></script>

</body>

</html>